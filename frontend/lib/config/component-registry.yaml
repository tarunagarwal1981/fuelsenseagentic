# ============================================================================
# Component Registry Configuration
# Maps agent state outputs → React UI components
# ============================================================================

components:
  # ========================================
  # Map Component - Rich Route Visualization (bunker ports, ECA overlays, tooltips)
  # ========================================
  - id: route_map
    name: "Route Map Viewer"
    component: "RichMap"
    description: "Interactive maritime route map with bunker ports, ECA zones, tooltips"
    
    required_state_fields:
      - route_data.waypoints
      - route_data.origin_port_code
      - route_data.destination_port_code
    
    optional_state_fields:
      - bunker_analysis.recommendations
      - bunker_ports
      - compliance_data.eca_zones
    
    render_conditions:
      - "route_data && route_data.waypoints && route_data.waypoints.length > 0"
    
    produced_by:
      - route_agent
    
    priority: 0
    tier: 0
    
    props_mapping:
      route: "route_data"
      analysis: "bunker_analysis"
      bunker_ports: "bunker_ports"

  # ========================================
  # Bunker Cost Comparison
  # ========================================
  - id: bunker_comparison
    name: "Bunker Cost Comparison"
    component: "CostComparison"
    description: "Compare bunker costs across ports"
    
    required_state_fields:
      - bunker_analysis.recommendations
    
    optional_state_fields:
      - bunker_analysis.best_option
    
    render_conditions:
      - "bunker_analysis && bunker_analysis.recommendations && bunker_analysis.recommendations.length >= 1"
    
    produced_by:
      - bunker_agent
    
    priority: 1
    tier: 1
    
    props_mapping:
      options: "bunker_analysis.recommendations"
      recommendation: "bunker_analysis.best_option"

  # ========================================
  # ECA Compliance Card
  # ========================================
  - id: eca_compliance
    name: "ECA Compliance Overview"
    component: "ECAComplianceCard"
    description: "ECA zone compliance and fuel switching"
    
    required_state_fields:
      - eca_segments
    
    optional_state_fields:
      - compliance_data.eca_violations
      - compliance_data.fuel_switching_points
    
    render_conditions:
      - "eca_segments && eca_segments.length > 0"
    
    produced_by:
      - compliance_agent
      - route_agent
    
    priority: 2
    tier: 2
    
    props_mapping:
      ecaSegments: "eca_segments"
      violations: "compliance_data.eca_violations"
      switchingPoints: "compliance_data.fuel_switching_points"

  # ========================================
  # Bunker Table (EnhancedBunkerTable)
  # ========================================
  - id: bunker_table
    name: "Bunker Analysis Table"
    component: "EnhancedBunkerTable"
    description: "Bunker port recommendations with costs and deviations"
    
    required_state_fields:
      - bunker_analysis.recommendations
    
    optional_state_fields:
      - bunker_analysis.best_option
    
    render_conditions:
      - "bunker_analysis && bunker_analysis.recommendations && bunker_analysis.recommendations.length > 0"
    
    produced_by:
      - bunker_agent
    
    priority: 1
    tier: 1
    
    props_mapping:
      bunkerAnalysis: "bunker_analysis"
      complianceData: "compliance_data"

  # ========================================
  # Weather Timeline
  # ========================================
  - id: weather_timeline
    name: "Weather Timeline"
    component: "WeatherTimeline"
    description: "Weather forecast along route over time"
    
    required_state_fields:
      - weather_forecast
      - vessel_timeline
    
    render_conditions:
      - "weather_forecast && weather_forecast.timeline && weather_forecast.timeline.length > 0"
    
    produced_by:
      - weather_agent
    
    priority: 3
    tier: 2
    
    props_mapping:
      forecast: "weather_forecast"
      vesselTimeline: "vessel_timeline"

  # ========================================
  # Speed–Consumption Chart (ballast/laden)
  # ========================================
  - id: speed-consumption-chart
    name: "Speed–Consumption Chart"
    component: "SpeedConsumptionChart"
    description: "Speed vs consumption chart with ballast/laden tabs, polynomial fits, and baseline comparison"
    required_state_fields:
      - hull_performance_charts.speedConsumption
    render_conditions:
      - "hull_performance_charts && hull_performance_charts.speedConsumption != null"
    produced_by:
      - hull_performance_agent
    priority: 4
    tier: 2
    props_mapping:
      data: "hull_performance_charts.speedConsumption"

# ============================================================================
# Query Type → Component Mappings
# ============================================================================

query_type_mappings:
  bunker_planning:
    components:
      - route_map
      - bunker_table
      - weather_timeline
      - eca_compliance
    
  route_calculation:
    components:
      - route_map
    
  weather_analysis:
    components:
      - route_map
      - weather_timeline
    
  compliance_check:
    components:
      - route_map
      - eca_compliance

# ============================================================================
# Fallback Strategy
# ============================================================================

fallback:
  strategy: llm_synthesis
  
  llm_config:
    model: claude-sonnet-4-5
    temperature: 0.3
    max_tokens: 2000
    
  always_show_as_text:
    - final_recommendation
    - agent_errors
    - clarification_question
